#!/usr/bin/python
# -*- coding: utf-8 -*-

import sys
PY2 = sys.version_info.major == 2

class Settings(object):
    def get_setting(self, name):
        from xbmcaddon import Addon
        addon = Addon()
        return addon.getSetting(name)

    def set_setting(self, name, value):
        from xbmcaddon import setSetting
        setSetting(name, value)

class Tracker:
    def __init__(self):
        self.settings = Settings()

    def Search(self, info):
        t = info['originaltitle']
        if PY2 and isinstance(t, str): 
            t = t.decode('utf8')

        Lout = []

        from vdlib.scrappers.rutracker import RuTrackerBase

        rutracker = RuTrackerBase(self.settings)

        for item in rutracker.search(t):

            Lout.append({
                "sids": item['seeds'],
                "size": item['size'],
                "title":item['title'],
                "url": item['dl_link']
            })
            pass

        return Lout

    def Query(self, query):
        try:
            return self.Search({'originaltitle': query})
        except Exception as e:
            print(e)
            return []

if __name__ == '__main__':
    print(Tracker().Query('ария'))
